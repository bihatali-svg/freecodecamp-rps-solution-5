from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Embedding, Bidirectional, Dense, Dropout, GlobalAveragePooling1D

# --- Model Definition ---
model = Sequential([
    # 1. Embedding Layer: Converts integer indices into dense vectors
    Embedding(VOCAB_SIZE, EMBEDDING_DIM, input_length=MAX_LEN),
    
    # 2. Sequence Processing Layer (RNN): Bidirectional LSTM is robust
    Bidirectional(tf.keras.layers.LSTM(32)),
    # OR for a simpler model: GlobalAveragePooling1D() for feature vector

    # 3. Dense Hidden Layer
    Dense(24, activation='relu'),
    Dropout(0.5),
    
    # 4. Output Layer: Single neuron with sigmoid for binary classification
    Dense(1, activation='sigmoid')
])

# --- Model Compilation ---
model.compile(
    loss='binary_crossentropy',
    optimizer='adam',
    metrics=['accuracy']
)

# --- Model Training ---
NUM_EPOCHS = 15
BATCH_SIZE = 128

history = model.fit(
    train_padded, 
    train_labels, 
    epochs=NUM_EPOCHS, 
    batch_size=BATCH_SIZE,
    validation_data=(test_padded, test_labels),
    verbose=1
)

# Optional: Evaluate the final model accuracy on the test set
# loss, accuracy = model.evaluate(test_padded, test_labels)
# print(f"Final Test Accuracy: {accuracy*100:.2f}%")
